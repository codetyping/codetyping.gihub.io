<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Events 0.1</title>
    <link rel="stylesheet" href="static/styles.css">
</head>



<body>
    <textarea id="type"
        style="width: 400px; height:100px;">Lorem ipsum dolor sit, amet consectetur adipisicing elit. Rem eum eligendi, enim eos nobis tenetur est
        vero ab minima quae, deserunt iure qui quod voluptas unde omnis exercitationem perferendis consectetur.</textarea>
    <br><br>
    <button id="loadButton">Load text</button>
    <p id="output">Press any key...</p>
    <p id="count">you have pressed key <span id="countNum"> </span> times </p>



    <div id="conv">HERE goes converted text:</p=div>

        <script>

            const inputArea = document.querySelector('#type');
            let text = inputArea.value;
            const divConvertText = document.querySelector('#conv');
            const spanCountElement = document.querySelector('#countNum');
            const loadButton = document.querySelector('#loadButton');
            let tIndex = 0;

            //convert text with span elements
            convertText();

            loadButton.addEventListener('click', convertText);

            function convertText() {
                divConvertText.replaceChildren();
                text = inputArea.value;
                text = text.trim();
                [...text].forEach((t, i) => {
                    spanElement = document.createElement('span');
                    spanElement.textContent = text[i];
                    divConvertText.appendChild(spanElement);
                });
                tIndex = 0;
            }

            document.addEventListener('keydown', function (event) {
                let keyPressed = event.key;
                let allSpan = document.querySelectorAll('div#conv span');
                spanCountElement.textContent = tIndex;

                if (keyPressed.length == 1 || keyPressed == 'Backspace') {

                    if (keyPressed !== 'Backspace') {
                       allSpan[tIndex].className = keyPressed == text[tIndex] ? 'correct' : 'incorrect';

                        tIndex++;
                    } else {
                        tIndex--;
                        allSpan[tIndex].className = 'neutral'; 
                    }
           
                }

                if (event.shiftKey) {
                    if (event.key === 'Enter' || event.key === 'NumpadEnter') {
                        //console.log('Shift + Enter pressed');
                        tIndex++;
                    }
                }
            });



        </script>
</body>



</html>